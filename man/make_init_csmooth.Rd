% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_cSmoothEM.R
\name{make_init_csmooth}
\alias{make_init_csmooth}
\title{Initialization from an ordering vector for csmoothEM}
\usage{
make_init_csmooth(
  X,
  ordering_vec,
  K,
  modelName = c("homoskedastic", "heteroskedastic"),
  nugget = 0,
  discretization = c("equal", "quantile", "kmeans"),
  na_action = c("drop", "error"),
  eps = 1e-12
)
}
\arguments{
\item{X}{Numeric matrix \code{(n x d)}.}

\item{ordering_vec}{Numeric vector of length \code{n} (can contain NA).}

\item{K}{Integer >= 2; number of mixture components.}

\item{modelName}{Either \code{"homoskedastic"} or \code{"heteroskedastic"}.}

\item{nugget}{Nonnegative scalar added to variance estimates.}

\item{discretization}{One of \code{"equal"}, \code{"quantile"}, \code{"kmeans"}.}

\item{na_action}{How to handle NA in \code{ordering_vec}: \code{"drop"} or \code{"error"}.}

\item{eps}{Small positive floor for \code{pi} and \code{sigma2}.}
}
\value{
A list with:
\itemize{
  \item \code{pi}: length-\code{K} mixing proportions.
  \item \code{mu}: list of length \code{K}, each a length-\code{d} mean vector.
  \item \code{sigma2}: diagonal variances; length-\code{d} vector (homoskedastic) or \code{d x K} matrix (heteroskedastic).
  \item \code{keep_idx}: row indices kept after NA handling.
  \item \code{cluster_rank}: integer vector in \code{1..K} for each kept row.
}
}
\description{
Initializes csmoothEM parameters from a 1D ordering score by:
\enumerate{
  \item Discretizing \code{ordering_vec} into \code{K} ordered groups (equal/quantile/kmeans).
  \item Computing component means \code{mu}.
  \item Estimating diagonal variances \code{sigma2} under either:
    \itemize{
      \item \code{modelName="homoskedastic"}: one variance per coordinate shared across clusters (length \code{d}).
      \item \code{modelName="heteroskedastic"}: one variance per coordinate per cluster (\code{d x K}).
    }
}

This function mirrors the discretization and mean construction logic of \code{make_init()},
but returns \code{sigma2} (diagonal variances) instead of a list of full covariance matrices.
}
