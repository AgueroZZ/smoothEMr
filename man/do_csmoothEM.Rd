% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_cSmoothEM.R
\name{do_csmoothEM}
\alias{do_csmoothEM}
\title{Run csmoothEM iterations}
\usage{
do_csmoothEM(
  object,
  data = NULL,
  iter = 1,
  record = TRUE,
  adaptive = NULL,
  lambda_min = NULL,
  lambda_max = NULL,
  sigma_update = c("mstep", "ml"),
  sigma_min = 1e-10,
  sigma_max = 1e+10,
  verbose = FALSE
)
}
\arguments{
\item{object}{A \code{csmooth_em} object.}

\item{data}{Optional n-by-d data matrix. If NULL, uses \code{object$data}.}

\item{iter}{Integer \eqn{\ge 1}; number of EM iterations to run.}

\item{record}{Logical; if TRUE, record traces.}

\item{adaptive}{Adaptive option controlling \eqn{\lambda} updates:
\describe{
  \item{\code{NULL}}{Inherit \code{object$control$adaptive}.}
  \item{\code{"none"}}{No adaptive update (fixed \code{lambda_vec}).}
  \item{\code{"prior"}}{Prior-based update for \eqn{\lambda_j} using the current M-step \eqn{\mu}.}
  \item{\code{"ml"}}{Collapsed-ML update for \eqn{\lambda_j} (dispatches to
    \code{\link{do_csmoothEM_ml_collapsed}}).}
}
A logical value is accepted for backward compatibility: \code{TRUE} is treated as
\code{"prior"} and \code{FALSE} as \code{"none"}.}

\item{lambda_min, lambda_max}{Positive bounds used for adaptive \eqn{\lambda} updates.}

\item{sigma_update}{Character. Only used when \code{adaptive="ml"} (i.e., in the
collapsed-ML path). Either \code{"mstep"} or \code{"ml"}; see
\code{\link{do_csmoothEM_ml_collapsed}}.}

\item{sigma_min, sigma_max}{Positive bounds for \code{sigma2} when \code{adaptive="ml"}
and \code{sigma_update="ml"}.}

\item{verbose}{Logical; if TRUE, print a short progress line each iteration.}
}
\value{
Updated \code{csmooth_em} object.
}
\description{
Runs EM iterations for coordinate-specific SmoothEM (\code{csmooth_em}).
Supports adaptive updates of the coordinate-wise smoothing parameters \eqn{\lambda_j}.

When \code{adaptive = "ml"}, this function dispatches to
\code{\link{do_csmoothEM_ml_collapsed}} (collapsed-ML variant). In that case,
\code{sigma_update} controls whether \eqn{\sigma^2} is updated via the standard
M-step or via collapsed-ML optimization.
}
