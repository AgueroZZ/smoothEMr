cfit
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_smoothEM(X = as.matrix(sim$obs), method = "tSNE", rw_q = 2)
fit <- fit |>
do_smoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
# initialize using tSNE
set.seed(123)
fit <- initialize_smoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10)
set.seed(123)
cfit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
cfit <- cfit |>
do_csmoothEM(iter = 10)
fit
cfit
set.seed(123)
fit <- initialize_smoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
fit
set.seed(123)
cfit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
cfit
?do_csmoothEM
set.seed(123)
fit <- initialize_smoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10, adaptive = FALSE)
set.seed(123)
cfit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE", lambda = 1, adaptive = F)
cfit <- cfit |>
do_csmoothEM(iter = 10, adaptive = FALSE)
fit
fit$elbo_trace
cfit
cfit$elbo_trace
X <- rbind(
matrix(rnorm(1000, mean = 0), ncol = 2),
matrix(rnorm(1000, mean = 5), ncol = 2),
matrix(rnorm(1000, mean = 10), ncol = 2)
)
# initialize using tSNE
set.seed(123)
fit <- initialize_smoothEM(X = X, method = "tSNE", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10, adaptive = FALSE)
fit
X <- rbind(
matrix(rnorm(1000, mean = 0), ncol = 6),
matrix(rnorm(1000, mean = 5), ncol = 6),
matrix(rnorm(1000, mean = 10), ncol = 6)
)
# initialize using tSNE
set.seed(123)
fit <- initialize_smoothEM(X = X, method = "tSNE", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10, adaptive = FALSE)
set.seed(123)
cfit <- initialize_csmoothEM(X = X, method = "tSNE", lambda = 1, adaptive = F)
cfit <- cfit |>
do_csmoothEM(iter = 10, adaptive = FALSE)
dim(X)
fit
cfit
fit$elbo_trace - cfit$elbo_trace
# initialize using tSNE
set.seed(123)
fit <- initialize_smoothEM(X = X, method = "fiedler", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10, adaptive = FALSE)
set.seed(123)
cfit <- initialize_csmoothEM(X = X, method = "fiedler", lambda = 1, adaptive = F)
cfit <- cfit |>
do_csmoothEM(iter = 10, adaptive = FALSE)
fit
cfit
X <- rbind(
matrix(rnorm(1000, mean = 0), ncol = 6),
matrix(rnorm(1000, mean = 5), ncol = 6),
matrix(rnorm(1000, mean = 10), ncol = 6)
)
# initialize using tSNE
set.seed(123)
fit <- initialize_smoothEM(X = X, method = "fiedler", lambda = 1, adaptive = F)
fit <- fit |>
do_smoothEM(iter = 10, adaptive = FALSE)
set.seed(123)
cfit <- initialize_csmoothEM(X = X, method = "fiedler", lambda = 1, adaptive = F)
cfit <- cfit |>
do_csmoothEM(iter = 10, adaptive = FALSE)
fit
cfit
fit$params$sigma
fit$params$sigma[[1]]
cfit$params$sigma2
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE", rw_q = 2)
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
fit
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE", rw_q = 2)
fit
fit_pca <- initialize_smoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_smoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_smoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_smoothEM(iter = 100)
plot(fit_fiedler)
fit_pca
fit_fiedler
fit_pca <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_csmoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_csmoothEM(iter = 100)
plot(fit_fiedler)
fit_fiedler
?optimize_initial_csmoothEM
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE")
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE")
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
fit_pca <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_csmoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_csmoothEM(iter = 100)
plot(fit_fiedler)
best <- optimize_initial(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
m_max = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best, plot_type = "scatterplot", dims = c(1,2))
best_fit <- best |>
do_smoothEM(iter = 50)
plot(best_fit)
best <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best, plot_type = "scatterplot", dims = c(1,2))
best_fit <- best |>
do_csmoothEM(iter = 50)
plot(best_fit)
best_2 <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 30,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best_2, plot_type = "scatterplot", dims = c(1,2))
best_2
source("~/Desktop/smoothEMr/R/06_cSmoothEM.R", echo = TRUE)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE")
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
fit_pca <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_csmoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_csmoothEM(iter = 100)
plot(fit_fiedler)
best <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best, plot_type = "scatterplot", dims = c(1,2))
best_fit <- best |>
do_csmoothEM(iter = 50)
plot(best_fit)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE")
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
fit_pca <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_csmoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_csmoothEM(iter = 100)
plot(fit_fiedler)
best <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
best <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(smoothEMr)
simulate_swiss_roll_1d_2d <- function(n = 800,
t_range = c(1.5 * pi, 6 * pi),
sigma = 0.15,     # can be scalar or length-2
seed = 1) {
stopifnot(length(t_range) == 2)
stopifnot(length(sigma) == 1 || length(sigma) == 2)
set.seed(seed)
# 1D parameter
t <- runif(n, min = t_range[1], max = t_range[2])
# true 2D "swiss roll" (spiral)
x_true <- t * cos(t)
y_true <- t * sin(t)
# noise
if (length(sigma) == 1) sigma <- rep(sigma, 2)
x_obs <- x_true + rnorm(n, 0, sigma[1])
y_obs <- y_true + rnorm(n, 0, sigma[2])
list(
t = t,
truth = data.frame(x = x_true, y = y_true),
obs   = data.frame(x = x_obs,  y = y_obs)
)
}
sim <- simulate_swiss_roll_1d_2d(n = 1500, sigma = 0.2, seed = 123)
plot(sim$obs$x, sim$obs$y, pch = 16, cex = 0.35, col = "grey80",
xlab = "x", ylab = "y", main = "Noisy 2D swiss-roll (spiral)")
pal <- colorRampPalette(c("navy", "cyan", "yellow", "red"))(256)
t_scaled <- (sim$t - min(sim$t)) / (max(sim$t) - min(sim$t))  # in [0,1]
col_t <- pal[pmax(1, pmin(256, 1 + floor(255 * t_scaled)))]
points(sim$truth$x, sim$truth$y, pch = 16, cex = 0.25, col = col_t)
set.seed(123)
# initialize using tSNE
fit <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "tSNE")
fit <- fit |>
do_csmoothEM(iter = 100)
# plot results
plot(fit)
plot(fit, plot_type = "elbo")
fit_pca <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "PCA") |>
do_csmoothEM(iter = 100)
plot(fit_pca)
fit_fiedler <- initialize_csmoothEM(X = as.matrix(sim$obs), method = "fiedler") |>
do_csmoothEM(iter = 100)
plot(fit_fiedler)
best <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 5,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best, plot_type = "scatterplot", dims = c(1,2))
best_fit <- best |>
do_csmoothEM(iter = 50)
plot(best_fit)
best_2 <- optimize_initial_csmoothEM(
as.matrix(sim$obs),
num_iter = 30,
num_cores = 6,
two_panel = FALSE,
plot = TRUE
)
plot(best_2, plot_type = "scatterplot", dims = c(1,2))
