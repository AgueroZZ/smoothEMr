% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_cSmoothEM.R
\name{as_csmooth_em}
\alias{as_csmooth_em}
\title{Construct a csmooth_em object}
\usage{
as_csmooth_em(
  params,
  gamma = NULL,
  data = NULL,
  Q_K,
  lambda_vec,
  rw_q = 2,
  ridge = 0,
  modelName = c("homoskedastic", "heteroskedastic"),
  relative_lambda = TRUE,
  nugget = 0,
  eigen_tol = NULL,
  meta = NULL
)
}
\arguments{
\item{params}{List with fields:
\itemize{
  \item \code{pi}: length-K mixing proportions.
  \item \code{mu}: list of length K; each element is a length-d mean vector.
  \item \code{sigma2}: either
    \itemize{
      \item length-d numeric vector (homoskedastic), or
      \item d-by-K numeric matrix (heteroskedastic).
    }
}}

\item{gamma}{(optional) n-by-K responsibility matrix.}

\item{data}{(optional) n-by-d data matrix.}

\item{Q_K}{K-by-K base precision matrix along components (RW prior along K).
Should be built with \code{lambda = 1}. Coordinate penalties are in \code{lambda_vec}.}

\item{lambda_vec}{length-d nonnegative vector of per-coordinate lambdas.}

\item{rw_q}{RW order along K (e.g. 1 or 2). Used as rank deficiency in generalized logdet.}

\item{ridge}{Ridge used in building \code{Q_K} (stored for provenance).}

\item{modelName}{One of \code{"homoskedastic"} or \code{"heteroskedastic"}.}

\item{relative_lambda}{Logical; if TRUE, scale the prior for coordinate j by
\eqn{1/\sigma_j^2} (homoskedastic) or \eqn{1/\bar\sigma_j^2} (heteroskedastic; see details).}

\item{nugget}{Nonnegative jitter added to variances after updates.}

\item{eigen_tol}{Optional tolerance for generalized logdet.}

\item{meta}{Optional list of metadata.}
}
\value{
An object of class \code{csmooth_em}.
}
\description{
Create a coordinate-specific SmoothEM object (\code{csmooth_em}) with
diagonal covariance and a separable RW prior along the K dimension.
Each coordinate \eqn{j} has its own penalty strength \eqn{\lambda_j}.

Supported covariance models (diagonal only):
\itemize{
  \item \code{"homoskedastic"}: \eqn{\sigma^2_j} shared across clusters (but varies across coordinates).
  \item \code{"heteroskedastic"}: \eqn{\sigma^2_{j,k}} varies across both coordinates and clusters.
}
}
\details{
For \code{modelName="heteroskedastic"} and \code{relative_lambda=TRUE}, we use
\eqn{\bar\sigma_j^2 = \sum_k \pi_k \sigma^2_{j,k}} as a reference scale for the
prior scaling. This is a pragmatic analogue of the EEI-style scaling.
}
