% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_methods.R
\name{plot_EM_embedding}
\alias{plot_EM_embedding}
\title{Plot data embedding with SmoothEM component means}
\usage{
plot_EM_embedding(
  fit,
  X,
  dims = c(1, 2),
  position = NULL,
  use_posterior_mean = TRUE,
  pch = 19,
  col = "grey60",
  cex = 0.7,
  mu_pch = 8,
  mu_col = "orange",
  mu_cex = 1,
  arrow_col = "orange",
  arrow_lwd = 3,
  arrow_len = 0.08,
  line_col = "orange",
  line_lwd = 2,
  add = FALSE,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  ...
)
}
\arguments{
\item{fit}{A fitted object returned by \code{EM_algorithm()}.}

\item{X}{Numeric matrix (n x d). The data used to fit the model.}

\item{dims}{Integer vector of length 1 or 2 indicating which coordinates (columns of X) to plot.}

\item{position}{Optional numeric vector of length n giving x-axis "position".
If NULL, uses \code{fit$position} if present; otherwise uses posterior mean position computed as
\code{fit$gamma \%*\% seq_len(K)}.}

\item{use_posterior_mean}{Logical; if TRUE (default), use posterior mean position.
If FALSE, use MAP position via \code{max.col(fit$gamma)}.}

\item{pch, col, cex}{Point style for data scatter.}

\item{mu_pch, mu_col, mu_cex}{Mean point style.}

\item{arrow_col, arrow_lwd, arrow_len}{Arrow style (2D only).}

\item{line_col, line_lwd}{Mean curve style (1D only).}

\item{add}{Logical; if TRUE, add to existing plot.}

\item{xlab, ylab, main}{Labels; if NULL, auto-generated.}

\item{...}{Passed to \code{plot()} for the scatter.}
}
\value{
Invisibly returns a list with \code{dims}, \code{pos}, \code{mu_mat}.
}
\description{
Visualize an EM fit (from \code{EM_algorithm()}) on 1D or 2D selected coordinates.
For 2D, draws arrows connecting component means in order. For 1D, draws a scatter
of posterior position vs the selected coordinate and overlays the mean curve.
}
