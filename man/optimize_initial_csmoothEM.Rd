% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_cSmoothEM.R
\name{optimize_initial_csmoothEM}
\alias{optimize_initial_csmoothEM}
\title{Optimize csmoothEM initialization by comparing multiple methods after a warm start}
\usage{
optimize_initial_csmoothEM(
  X,
  methods = c("PCA", "tSNE", "random", "fiedler", "pcurve"),
  num_iter = 5,
  num_cores = 2,
  K = NULL,
  adaptive = "prior",
  lambda_min = 1e-08,
  lambda_max = 1e+08,
  sigma_update = c("mstep", "ml"),
  sigma_min = 1e-10,
  sigma_max = 1e+10,
  plot = FALSE,
  two_panel = FALSE,
  seed = NULL,
  quiet = TRUE,
  ...
)
}
\arguments{
\item{X}{Numeric matrix \code{(n x d)}.}

\item{methods}{Character vector of initialization methods. Default includes
\code{"PCA"}, \code{"tSNE"}, \code{"random"}, \code{"fiedler"}, \code{"pcurve"}.}

\item{num_iter}{Integer \eqn{\ge 1}. Number of warm-start iterations to run per method.}

\item{num_cores}{Integer \eqn{\ge 1}. Number of cores to use (see \code{\link{parallel_initial_csmoothEM}}).}

\item{K}{Optional integer \eqn{\ge 2}. Number of mixture components. If \code{NULL},
the default logic in \code{initialize_csmoothEM} is used.}

\item{adaptive}{Character. One of \code{"none"}, \code{"prior"}, \code{"ml"}.
Logical values are accepted for backward compatibility: \code{TRUE} is treated as
\code{"prior"} and \code{FALSE} as \code{"none"}.}

\item{lambda_min, lambda_max}{Positive bounds for \code{lambda_vec} when \code{adaptive!="none"}.}

\item{sigma_update}{Character. Only used when \code{adaptive="ml"} (passed through).
Either \code{"mstep"} or \code{"ml"}.}

\item{sigma_min, sigma_max}{Positive bounds for \code{sigma2} when \code{adaptive="ml"} and
\code{sigma_update="ml"}.}

\item{plot}{Logical; if \code{TRUE}, plot traces across methods.}

\item{two_panel}{Logical; if \code{TRUE}, also plot penalized objective traces in a second panel.}

\item{seed}{Optional integer seed. If provided, a different derived seed is used per method.}

\item{quiet}{Logical; reserved for future use.}

\item{...}{Additional arguments passed to \code{initialize_csmoothEM} (and downstream ordering routines).}
}
\value{
A \code{csmooth_em} object corresponding to the selected best method.
  The returned object has an additional \code{meta$initial_search} list containing:
  \itemize{
    \item \code{best_method}: selected method name
    \item \code{criterion}: selection criterion (\code{"ml_last"} or \code{"elbo_last"})
    \item \code{summary}: the per-method summary data.frame
    \item \code{fits}: the full named list of fits
    \item \code{options}: options used for the search
  }
}
\description{
Runs several initialization methods (via \code{\link{parallel_initial_csmoothEM}}),
each for \code{num_iter} warm-start iterations, then selects the best fit.

Selection criterion:
\itemize{
  \item If \code{adaptive == "ml"}, selects the fit with the largest \code{ml_last}
        (collapsed objective \eqn{\mathcal{C}}).
  \item Otherwise, selects the fit with the largest \code{elbo_last}.
}

If \code{plot=TRUE}, plots traces across methods and highlights the selected best method.
When \code{adaptive=="ml"}, the primary plot shows \code{ml_trace}; otherwise it shows
\code{elbo_trace}. If \code{two_panel=TRUE}, a second panel shows \code{loglik_trace}.
}
\seealso{
\code{\link{parallel_initial_csmoothEM}}, \code{\link{initialize_csmoothEM}}
}
