% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/07_partition.R
\name{backward_two_ordering_partition_csmooth}
\alias{backward_two_ordering_partition_csmooth}
\title{Backward greedy feature partition into two orderings (csmoothEM, warm-start only)}
\usage{
backward_two_ordering_partition_csmooth(
  X,
  K = 50,
  init_method1 = c("fiedler", "PCA", "tSNE", "pcurve", "random"),
  seed2 = NULL,
  score_mode = c("ml", "none"),
  adaptive = NULL,
  rw_q = 2,
  relative_lambda = TRUE,
  lambda_min = 1e-10,
  lambda_max = 1e+10,
  discretization = c("quantile", "equal", "kmeans"),
  warm_iter_init = 10,
  warm_iter_refit = 5,
  max_steps = 50,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{X}{Numeric matrix \code{(n x d)}.}

\item{K}{Integer \eqn{\ge 2}. Number of mixture components.}

\item{init_method1}{Ordering initializer for ordering 1, passed to \code{\link{initialize_csmoothEM}}.}

\item{seed2}{Optional integer. If NULL, chosen as the worst-aligned feature under ordering 1.}

\item{score_mode}{One of \code{"ml"} or \code{"none"}; passed to \code{\link{score_feature_given_Gamma}}.}

\item{adaptive}{Adaptive mode used in \code{\link{do_csmoothEM}} warm updates (\code{"ml"} or \code{"none"}).
If NULL, defaults to \code{score_mode}.}

\item{rw_q}{Integer \eqn{\ge 0}. RW rank deficiency.}

\item{relative_lambda}{Logical.}

\item{lambda_min, lambda_max}{Bounds for lambda optimization when \code{score_mode="ml"}.}

\item{discretization}{Discretization used in initialization (recommended: \code{"quantile"}).}

\item{warm_iter_init}{Initial warm-start iterations for ordering 1.}

\item{warm_iter_refit}{Warm-start iterations after each move (applied to both fits).}

\item{max_steps}{Maximum number of greedy moves.}

\item{verbose}{Logical.}

\item{...}{Passed to \code{\link{initialize_csmoothEM}} for ordering 1.}
}
\value{
A list with:
\itemize{
  \item \code{assign}: character vector length d in \code{c("A","B")}.
  \item \code{J1}, \code{J2}: feature indices (original X column indices) in each ordering.
  \item \code{seedB}: seed feature index for ordering 2.
  \item \code{fit1}, \code{fit2}: \code{csmooth_em} objects for each ordering.
  \item \code{history}: data.frame of moves (feature, gain, sizes).
}
}
\description{
Warm-start backward greedy algorithm for partitioning features into two latent orderings.
The procedure initializes ordering 1 once on all features, initializes ordering 2 once
from a single seed feature via a rank-based 1D seed (no global ordering method), and then
performs greedy moves using only warm-start updates (drop/append + a few EM iterations).

At each step, the algorithm selects the feature in ordering 1 with the largest positive
gain \eqn{\Delta_j = S_2(j \mid \Gamma_2) - S_1(j \mid \Gamma_1)} and moves it to ordering 2,
where \eqn{S_k} is computed by \code{\link{score_feature_given_Gamma}} under the current responsibilities.

This function never re-calls ordering initializers (e.g. fiedler/pcurve/PCA) after the initial
construction. Ordering updates are done only via warm-start csmoothEM iterations.
}
\seealso{
\code{\link{initialize_csmoothEM}}, \code{\link{do_csmoothEM}}, \code{\link{score_feature_given_Gamma}},
  \code{\link{append_coord_to_fit_csmooth}}, \code{\link{drop_coord_from_fit_csmooth}}
}
