% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/07_partition.R
\name{append_coord_to_fit_csmooth}
\alias{append_coord_to_fit_csmooth}
\title{Append one coordinate to a csmooth_em fit using a Gamma-based 1D initialization (internal)}
\usage{
append_coord_to_fit_csmooth(
  fit,
  xj,
  score_mode = c("ml", "none"),
  rw_q = 2,
  relative_lambda = TRUE,
  lambda_min = 1e-10,
  lambda_max = 1e+10
)
}
\arguments{
\item{fit}{A \code{csmooth_em} object (homoskedastic).}

\item{xj}{Numeric vector length n (the new feature column).}

\item{score_mode}{One of \code{"ml"} or \code{"none"}; controls how the 1D init is computed.}

\item{rw_q}{Integer RW rank deficiency along K.}

\item{relative_lambda}{Logical.}

\item{lambda_min, lambda_max}{Bounds for lambda optimization when \code{score_mode="ml"}.}
}
\value{
Updated \code{csmooth_em}.
}
\description{
Adds a new feature column to a \code{csmooth_em} object, initializing the new coordinate's
\eqn{\mu_{j\cdot}} and \eqn{\sigma_j^2} using \code{score_feature_given_Gamma} under the fit's
current responsibilities \code{fit$gamma}. Then appends the coordinate and sets its lambda
to 1 (it can be updated later by \code{do_csmoothEM} if adaptive is on).

This is a warm-start operation: it does not reinitialize the whole model.
}
\keyword{internal}
