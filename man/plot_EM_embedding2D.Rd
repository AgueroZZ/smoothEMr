% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_methods.R
\name{plot_EM_embedding2D}
\alias{plot_EM_embedding2D}
\title{Plot a 2D embedding with Smooth-EM component means overlaid}
\usage{
plot_EM_embedding2D(
  mu_list,
  X2,
  t_vec = NULL,
  mu_order = NULL,
  pch = 19,
  col = "grey60",
  cex = 0.7,
  mu_pch = 8,
  mu_col = "orange",
  mu_cex = 1,
  arrow_col = "orange",
  arrow_lwd = 2.5,
  arrow_len = 0.08,
  add = FALSE,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  add_legend = !is.null(t_vec),
  legend_title = "t",
  pal = (grDevices::colorRampPalette(c("#2b8cbe", "white", "#de2d26")))(256),
  ...
)
}
\arguments{
\item{mu_list}{A length-\eqn{K} list of mean vectors. Each element should be a numeric vector
of length at least 2, where the first two entries correspond to the coordinates in \code{X2}.}

\item{X2}{Numeric matrix of dimension \eqn{n \times 2} giving the embedding coordinates for observations.}

\item{t_vec}{Optional numeric vector of length \eqn{n}. If provided, points are colored by \code{t_vec}
using \code{pal}.}

\item{mu_order}{Optional integer permutation of \code{1:K} specifying the plotting order of components.
Defaults to \code{1:K}.}

\item{pch}{Point character for observations (passed to \code{\link[graphics]{points}} / \code{\link[graphics]{plot}}).}

\item{col}{Observation color used when \code{t_vec} is \code{NULL}.}

\item{cex}{Point size for observations.}

\item{mu_pch}{Point character for component means.}

\item{mu_col}{Color for component means.}

\item{mu_cex}{Point size for component means.}

\item{arrow_col}{Color for arrows connecting consecutive component means.}

\item{arrow_lwd}{Line width for arrows.}

\item{arrow_len}{Arrow head length (see \code{\link[graphics]{arrows}}).}

\item{add}{Logical; if \code{TRUE}, add to an existing plot. If \code{FALSE}, create a new plot.}

\item{xlab, ylab}{Axis labels. If \code{NULL}, defaults to \code{"dim 1"} and \code{"dim 2"}.}

\item{main}{Plot title. If \code{NULL}, uses a default title.}

\item{add_legend}{Logical; if \code{TRUE} and \code{t_vec} is provided, add a small legend (quantile ticks).}

\item{legend_title}{Title for the legend when \code{t_vec} is provided.}

\item{pal}{A vector of colors used to map \code{t_vec} to point colors. Defaults to a blue-white-red palette.}

\item{...}{Additional arguments passed to \code{\link[graphics]{plot}} when \code{add = FALSE}.}
}
\value{
An invisible list with elements:
\itemize{
  \item \code{X2}: the embedding coordinates used for plotting.
  \item \code{mu}: the \eqn{K \times 2} matrix of plotted component means (after \code{mu_order}).
  \item \code{mu_order}: the component order used.
}
}
\description{
Plot an \eqn{n \times 2} embedding (e.g., two selected dimensions, PCA/t-SNE/UMAP)
and overlay the Smooth-EM component means (\code{mu_list}) as points connected by arrows.
Optionally color observations by a continuous vector (e.g., a Fiedler vector).
}
\examples{
set.seed(1)
n <- 50
X2 <- cbind(rnorm(n), rnorm(n))
mu_list <- list(c(-1, -1), c(0, 0), c(1, 1))
t_vec <- rnorm(n)

plot_EM_embedding2D(mu_list, X2)
plot_EM_embedding2D(mu_list, X2, t_vec = t_vec, legend_title = "Fiedler")

}
